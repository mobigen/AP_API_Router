[default]
db = postgresql
host = 192.168.101.43
port = 16000

[postgresql]
host = 192.168.106.24
port = 25432
user = dhub
password = dhub.12#
database = dhub
schema = metasch
biz_meta_name_table = tb_biz_meta_name
biz_meta_map_table = tb_biz_meta_map
biz_meta_table = tb_biz_meta
category_table = tb_category

[mariadb]

[select_query]
getMetaNameDetail = select kor_name,
                        eng_name,
                        show_order,
                        name_id,
                        (case
                            when type = 0 then 'text'
                            when type = 1 then 'int'
                            when type = 2 then 'binary'
                        end
                        ) as type
                    from tb_biz_meta_name
                    where name_id = #name_id#;

getMetaNameList = SELECT kor_name,
                        eng_name,
                        show_order,
                        name_id,
                        (case
                            when type = 0 then 'text'
                            when type = 1 then 'int'
                            when type = 2 then 'binary'
                        end
                        ) as type
                    FROM tb_biz_meta_name
                    order by name_id;

getUseMetaNameList = select tbmn.kor_name,
                            tbmn.eng_name,
                            tbmn.show_order,
                            tbmn.name_id,
                            case
                                when tbmn.type = 0 then 'text'
                                when tbmn.type = 1 then 'int'
                                when tbmn.type = 2 then 'binary'
                                end as type,
                            case
                                when (select tbmm.name_id from tb_biz_meta_map tbmm where tbmn.name_id = tbmm.name_id) is null then 0
                                else 1
                                end as use_meta
                        from tb_biz_meta_name tbmn
                        order by tbmn.name_id;

getBizMetaForm = select item_id, kor_name, eng_name, tbmm.name_id, type as value_type
                    from  tb_biz_meta_map tbmm
                            left join  tb_biz_meta_name tbmn on tbmm.name_id = tbmn.name_id
                    order by item_id;

getBizMetaDetail = select T.biz_dataset_id as rowId,
                        array_agg(T.kor_name) as kor_name,
                        array_agg(T.eng_name) as eng_name,
                        array_agg(T.type)     as type,
                        array_agg(T.item_val) as data,
                        array_agg(T.item_id)  as columnKey
                    from (select biz_dataset_id, tbm.item_id, tbm.item_val, tbmm.name_id, kor_name, eng_name, type
                        from  tb_biz_meta tbm
                                right join  tb_biz_meta_map tbmm on tbm.item_id = tbmm.item_id
                                left join  tb_biz_meta_name tbmn on tbmm.name_id = tbmn.name_id
                        where biz_dataset_id = #database_id#
                        order by biz_dataset_id, item_id) T
                    group by biz_dataset_id
                    order by biz_dataset_id;

getBizMetaList = select T.biz_dataset_id as rowId,
                        array_agg(T.item_val) as data,
                        array_agg(T.item_id)  as columnKey
                    from (select biz_dataset_id, tbm.item_id, tbm.item_val, tbmm.name_id, kor_name, eng_name
                        from  tb_biz_meta tbm
                                right join  tb_biz_meta_map tbmm on tbm.item_id = tbmm.item_id
                                left join  tb_biz_meta_name tbmn on tbmm.name_id = tbmn.name_id
                        order by biz_dataset_id, item_id) T
                    group by biz_dataset_id
                    order by biz_dataset_id;

getMetaName = select * from tb_biz_meta_name tbmn where name_id = #name_id#;

getMetaMapList = select tbmn.kor_name, tbmn.eng_name, tbmm.item_id, tbmm.name_id
                    from tb_biz_meta_name tbmn
                    join tb_biz_meta_map tbmm on tbmn.name_id = tbmm.name_id;

getCategoryList = select * from  tb_category order by parent_id, node_id;

getMetaNameForView = select tbmm.item_id, tbmn.kor_name, tbmn.eng_name
                        from  tb_biz_meta_map tbmm
                        left join  tb_biz_meta_name tbmn on tbmn.name_id = tbmm.name_id;